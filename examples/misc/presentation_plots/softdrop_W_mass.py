# Local utilities
from jetmontecarlo.utils.plot_utils import *
from jetmontecarlo.utils.color_utils import *

# ------------------------------------
# Setting up figures
# ------------------------------------
def get_axes(title):
    """Shows tests plots for beta=2 GECF distributions."""
    # ---------------------
    # Setting up figures
    # ---------------------
    xlabel = r"$m$ (GeV)"
    ylabel = r"$\frac{1}{\sigma_0}\frac{{\rm d}\sigma}{{\rm d}m}$"
    xlim = (25, 200)
    ylim = (0, 0.06)

    # Fig and axes for plotting pdf
    fig, axes = aestheticfig(xlabel=xlabel,
                             ylabel=ylabel,
                             ylim=ylim,
                             xlim=xlim,
                             title=title,
                             ratio_plot=False,
                             showdate=False,
                             labeltext=None)
    axes[0].set_ylabel(ylabel, labelpad=25, rotation=0,
                       fontsize=18)

    # Hide the right and top spines
    axes[0].spines['right'].set_visible(False)
    axes[0].spines['top'].set_visible(False)

    # Only show ticks on the left and bottom spines
    axes[0].yaxis.set_ticks_position('left')
    axes[0].xaxis.set_ticks_position('bottom')

    plt.tight_layout()

    return fig, axes

def plot_ungroomed():
    fig, axes = get_axes("Ungroomed W Jet Mass Distribution")
    x_vals = [37.5965665236051,54.901287553648,67.1587982832618,
    71.244635193133,74.1287553648068,75.8111587982832,
    77.2532188841201,78.5751072961373,79.4163090128755,
    80.137339055794,80.6180257510729,80.8583690987124,
    81.5793991416309,82.5407725321888,84.5836909871245,
    86.5064377682403,87.8283261802575,89.1502145922747,
    90.9527896995708,94.1974248927039,95.3991416309013,
    97.2017167381974,99.4849785407725,101.047210300429,
    103.090128755364,104.89270386266,106.575107296137,
    108.738197424892,110.060085836909,111.261802575107,
    112.703862660944,114.025751072961,119.07296137339,
    121.596566523605,125.201716738197,127.484978540772,
    129.167381974248,130.609442060085,132.532188841201,
    134.695278969957,136.978540772532,139.021459227467,
    141.064377682403,144.068669527897,147.19313304721,
    149.356223175965,152.120171673819,153.442060085836,
    154.763948497854,156.085836909871,157.407725321888,
    160.532188841201,164.618025751073,166.300429184549,
    169.545064377682,171.948497854077,174.472103004291,
    176.274678111588,179.038626609442,181.922746781115,
    185.287553648068,189.974248927038,194.300429184549,
    198.62660944206]
    y_vals = [-3.42075256556523E-05,0.000786773090079823,0.00169897377423032,
    0.00179019384264537,0.00261117445838084,0.00315849486887115,
    0.00416191562143672,0.00635119726339795,0.00872291904218929,
    0.0117331812998859,0.0139680729760547,0.0150171037628278,
    0.0156556442417331,0.016339794754846,0.0172519954389965,
    0.0179361459521094,0.0185746864310148,0.0191676168757126,
    0.0195781071835803,0.0203534777651083,0.0203534777651083,
    0.0198517673888255,0.0192588369441277,0.018939566704675,
    0.0181185860889395,0.0171607753705815,0.016248574686431,
    0.0153363740022805,0.0147890535917901,0.0142417331812998,
    0.0129190421892816,0.0121436716077537,0.00954389965792474,
    0.00849486887115166,0.00735461801596352,0.0068072976054732,
    0.0062599771949829,0.00548460661345496,0.00489167616875713,
    0.00434435575826681,0.00416191562143672,0.00366020524515393,
    0.00334093500570125,0.00279361459521094,0.00256556442417332,
    0.00247434435575827,0.00215507411630559,0.00201824401368301,
    0.00206385404789053,0.00188141391106043,0.00174458380843785,
    0.00165336374002279,0.00156214367160775,0.0014709236031927,
    0.00133409350057013,0.0012884834663626,0.00133409350057013,
    0.00119726339794755,0.00115165336374002,0.00092360319270239,
    0.000969213226909918,0.000969213226909918,0.000786773090079823,
    0.000786773090079823]

    axes[0].plot(x_vals, y_vals, ls='-', lw=5,
                 color='forestgreen')
    fig.savefig("softdrop_ungroomed_w_mass.pdf", format='pdf')

def plot_groomed():
    fig, axes = get_axes("Groomed W Jet Mass Distribution")
    x_vals = [20.7725321888412,24.8583690987124,29.1845493562231,
              33.9914163090128,38.5579399141631,43.8454935622317,
              51.5364806866952,57.7854077253218,64.2746781115879,
              69.0815450643776,71.9656652360515,74.3690987124463,
              75.5708154506437,76.5321888412017,77.0128755364806,
              77.2532188841201,77.4935622317596,77.4935622317596,
              77.9742489270386,78.3347639484978,78.5751072961373,
              78.9356223175966,79.175965665236,79.4163090128755,
              79.656652360515,80.0171673819742,80.137339055794,
              80.4978540772532,80.8583690987124,81.4592274678111,
              81.5793991416309,81.6995708154506,82.0600858369099,
              82.3004291845493,82.5407725321888,82.7811158798283,
              83.0214592274678,83.1416309012875,83.7424892703863,
              84.1030042918455,84.7038626609442,85.1845493562231,
              86.1459227467811,86.8669527896995,87.9484978540772,
              89.5107296137339,92.0343347639485,96.4806866952789,
              100.32618025751,105.854077253218,110.540772532188,
              116.549356223176,123.519313304721,131.090128755364,
              140.223175965665,156.56652360515,171.467811158798,
              182.763948497854,195.502145922746]
    y_vals = [0.00288483466362599,0.00242873432155074,0.00206385404789053,
              0.00179019384264537,0.00179019384264537,0.00169897377423032,
              0.00151653363740023,0.00160775370581528,0.00197263397947548,
              0.0030672748004561,0.00443557582668187,0.00598631698973774,
              0.00844925883694412,0.0111858608893956,0.0132839224629418,
              0.015473204104903,0.0188483466362599,0.0208551881413911,
              0.0244127708095781,0.0276966932725199,0.0302508551881414,
              0.0335347776510832,0.0359064994298745,0.0386431014823261,
              0.0422919042189281,0.0461231470923603,0.0484036488027366,
              0.0509122006841505,0.0566134549600912,0.0505017103762827,
              0.0483124287343215,0.0457582668187001,0.0415621436716077,
              0.0377309007981756,0.034994298745724,0.0318928164196123,
              0.0287913340935005,0.0267844925883694,0.0234093500570125,
              0.0208551881413911,0.0173888255416191,0.0133751425313569,
              0.0104561003420752,0.00835803876852907,0.00603192702394526,
              0.00388825541619156,0.00215507411630559,0.00133409350057013,
              0.000877993158494877,0.00051311288483466,0.000467502850627132,
              0.000330672748004565,0.000330672748004565,0.00023945267958951,
              0.00023945267958951,0.000330672748004565,0.000330672748004565,
              0.000330672748004565,0.00023945267958951]

    axes[0].plot(x_vals, y_vals, ls='-', lw=5,
                 color='darkorchid')
    fig.savefig("softdrop_groomed_w_mass.pdf", format='pdf')

if __name__ == '__main__':
    plot_ungroomed()
    plot_groomed()
